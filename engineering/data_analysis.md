# 数据分析

## 已知情况

Criteo是源自法国的一家专注于个性化在线广告展示的科技公司，该公司于2014年举办了一次在线广告的点击率预估竞赛([Criteo-Kaggle竞赛](https://www.kaggle.com/c/criteo-display-ad-challenge))，2015年3月31日又公布了新的点击率预测数据集，该数据集总大小超过1T，总记录数超过40亿条，是CTR领域目前为止最大的开放数据集。该数据集的主要优势在于其数据规模足够大，活跃度较高，且相关论文资料较为丰富；但同样的，大体量的数据也就意味着每次训练所需的代价比较大。

- 该数据集([Criteo数据](http://labs.criteo.com/2013/12/download-terabyte-click-logs/))共包含24个文件，每个文件代表一天的数据

- 每个文件当中都包含相同的**40个字段**，其中共有13个连续型特征，26个离散型特征，有些字段可能为空值；

- 为避免泄漏用户个人信息，数据集所有**离散特征**都转化为32位的**hash值**以达到数据脱敏的目的；

- 文件当中各字段以 tab 进行分隔，第一个字段为标签字段，1为正例，代表点击，2-14为连续型字段，15-40为离散的hash值；


## 数据分析需求

- 数据量

- 正负样本数(关系到是否进行欠采样/过采样以及采样比例)

	- PNN采用负样本下采样+logloss，并对预测值进行修正；

- 连续值的分布情况(关系到是否以及如何对连续值进行离散化)

	- WDM 对连续值利用 cumulative distribution function 进行标准化， 然后根据 \\( \frac{i-1}{n-1}\\) 将连续值离散为 n 个字段；
	

- 离散值的分布情况(关系到 one-hot encoding 后的字段数量)


## label统计结果

9天数据共计越16亿条记录， 正负样本比例约为 3：100

day |  total | positive |  nagitive |  rate
- |  - | - |  - |  -
day_0 | 195841983 | 6286525 | 189555458 | 0.033164569
day_1 | 199563535 | 6373290 | 193190245 | 0.032989709
day_2 | 196792019 | 6249639 | 190542380 | 0.032799207
day_3 | 181115208 | 5804412 | 175310796 | 0.033109267
day_4 | 152115810 | 5242098 | 146873712 | 0.035691193
day_5 | 172548507 | 5840421 | 166708086 | 0.03503382
day_6 | 204846845 | 6482725 | 198364120 | 0.032680935
day_7 | 200801003 | 6655877 | 194145126 | 0.034282998
day_8 | 193772492 | 6388523 | 187383969 | 0.034093221
sum | 1697397402  | 55323510 |  1642073892 |  0.033691243

## 离散特征

离散特征离散值每天约 8千万， 也就意味着 one hot 过后， 至少会有 8千万的维度， 由于之前的代码写的有问题，所以目前还没办法确定这9天的离散值是否有重复， 现在已经修复了代码逻辑， 在重新计算当中， 具体的样本离散值总数后续补充；

col_name |day_0|day_1|day_2|day_3|day_4|day_5|day_6|day_7|day_8
- |-|-|-|-|-|-|-|-|-
cat_1|18576837|19053494|18614758|17657677|16444992|18523022|20111071|20050476|19421116
cat_2|29427|29611|29651|29549|29136|29345|29913|30160|30166
cat_3|15127|15049|15018|14935|14795|14824|15121|15176|15154
cat_4|7295|7189|7255|7228|7104|7118|7338|7269|7308
cat_5|19901|19546|19769|19666|19224|19316|20045|19813|19931
cat_6|3|3|3|3|3|3|3|3|3
cat_7|6465|6491|6513|6535|6513|6497|6566|6578|6588
cat_8|1310|1316|1323|1324|1316|1314|1326|1328|1331
cat_9|61|62|62|59|60|60|58|59|57
cat_10|11700067|12018268|11706506|11154703|10540645|11787078|12630043|12662553|12269234
cat_11|622921|707291|698074|666536|641479|667257|697434|686620|687583
cat_12|219556|218509|217897|214589|202958|209062|221789|220013|217864
cat_13|10|10|10|10|10|10|10|10|10
cat_14|2209|2209|2209|2209|2208|2207|2209|2209|2209
cat_15|9779|9797|9816|9809|9698|9735|9867|9869|9886
cat_16|71|72|86|71|71|69|73|72|72
cat_17|4|4|4|4|4|4|4|4|4
cat_18|963|953|959|956|943|949|967|960|964
cat_19|14|14|14|14|14|14|14|14|14
cat_20|22022124|22603235|22016296|20860924|19183024|21678326|23667638|23481809|22952958
cat_21|4384510|4553157|4478806|4274080|4025904|4431445|4750297|4734814|4643760
cat_22|15960286|16382859|16007216|15220147|14222951|16005307|17345375|17332825|16777855
cat_23|290588|291641|290810|286279|275075|284760|302921|299734|298720
cat_24|10829|10903|10844|10831|10680|10743|10908|10864|10912
cat_25|95|90|98|96|97|97|94|94|91
cat_26|34|34|35|34|33|34|35|34|35
total_row|73880486|75931807|74134032|70438268|65638937|73688596|79831119|79573360|77373825


## 连续特征

-|con_1|con_2|con_3|con_4|con_5|con_6|con_7|con_8|con_9|con_10|con_11|con_12|con_13
|-|-|-|-|-|-|-|-|-|-|-|-|-
min|1|1|0|0|1|0|0|-1|0|0|1|0|0
mean|35|426|7|130|22|1|0|112|9|0|4|21625|9
max|65535|8000|4933|746810|8000|65479|5277|400947|16050|19|555|35058398|21843


