<!DOCTYPE HTML>
<html>
 <head>
  <meta charset="utf-8"/>
  <title>
   Made with Remarkable!
  </title>
  <link href="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/styles/github.min.css" rel="stylesheet"/>
  <style type="text/css">
   body,table tr{background-color:#fff}table tr td,table tr th{border:1px solid #ccc;text-align:left;padding:6px 13px;margin:0}pre code,table,table tr{padding:0}hr,pre code{background:0 0}body{font:16px Helvetica,Arial,sans-serif;line-height:1.4;color:#333;word-wrap:break-word;padding:10px 15px}strong,table tr th{font-weight:700}h1{font-size:2em;margin:.67em 0;text-align:center}h2{font-size:1.75em}h3{font-size:1.5em}h4{font-size:1.25em}h1,h2,h3,h4,h5,h6{font-weight:700;position:relative;margin-top:15px;margin-bottom:15px;line-height:1.1}h1,h2{border-bottom:1px solid #eee}hr{height:0;margin:15px 0;overflow:hidden;border:0;border-bottom:1px solid #ddd}a{color:#4183C4}a.absent{color:#c00}ol,ul{padding-left:15px;margin-left:5px}ol{list-style-type:lower-roman}table tr{border-top:1px solid #ccc;margin:0}table tr:nth-child(2n){background-color:#aaa}table tr td :first-child,table tr th :first-child{margin-top:0}table tr td:last-child,table tr th :last-child{margin-bottom:0}img{max-width:100%}blockquote{padding:0 15px;border-left:4px solid #ccc}code,tt{margin:0 2px;padding:0 5px;white-space:nowrap;border:1px solid #eaeaea;background-color:#f8f8f8;border-radius:3px}pre code{margin:0;white-space:pre;border:none}.highlight pre,pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px}
  </style>
 </head>
 <body>
  <h1 id="_1">
   数据分析
  </h1>
  <h2 id="_2">
   已知情况
  </h2>
  <p>
   Criteo是源自法国的一家专注于个性化在线广告展示的科技公司，该公司于2014年举办了一次在线广告的点击率预估竞赛(
   <a href="https://www.kaggle.com/c/criteo-display-ad-challenge">
    Criteo-Kaggle竞赛
   </a>
   )，2015年3月31日又公布了新的点击率预测数据集，该数据集总大小超过1T，总记录数超过40亿条，是CTR领域目前为止最大的开放数据集。该数据集的主要优势在于其数据规模足够大，活跃度较高，且相关论文资料较为丰富；但同样的，大体量的数据也就意味着每次训练所需的代价比较大。
  </p>
  <ul>
   <li>
    <p>
     该数据集(
     <a href="http://labs.criteo.com/2013/12/download-terabyte-click-logs/">
      Criteo数据
     </a>
     )共包含24个文件，每个文件代表一天的数据
    </p>
   </li>
   <li>
    <p>
     每个文件当中都包含相同的
     <strong>
      40个字段
     </strong>
     ，其中共有13个连续型特征，26个离散型特征，有些字段可能为空值；
    </p>
   </li>
   <li>
    <p>
     为避免泄漏用户个人信息，数据集所有
     <strong>
      离散特征
     </strong>
     都转化为32位的
     <strong>
      hash值
     </strong>
     以达到数据脱敏的目的；
    </p>
   </li>
   <li>
    <p>
     文件当中各字段以 tab 进行分隔，第一个字段为标签字段，1为正例，代表点击，2-14为连续型字段，15-40为离散的hash值；
    </p>
   </li>
  </ul>
  <h2 id="_3">
   数据分析需求
  </h2>
  <ul>
   <li>
    <p>
     数据量
    </p>
   </li>
   <li>
    <p>
     正负样本数(关系到是否进行欠采样/过采样以及采样比例)
    </p>
    <ul>
     <li>
      PNN采用负样本下采样+logloss，并对预测值进行修正；
     </li>
    </ul>
   </li>
   <li>
    <p>
     连续值的分布情况(关系到是否以及如何对连续值进行离散化)
    </p>
    <ul>
     <li>
      WDM 对连续值利用 cumulative distribution function 进行标准化， 然后根据 \( \frac{i-1}{n-1}\) 将连续值离散为 n 个字段；
     </li>
    </ul>
   </li>
   <li>
    <p>
     离散值的分布情况(关系到 one-hot encoding 后的字段数量)
    </p>
   </li>
  </ul>
  <h2 id="label">
   label统计结果
  </h2>
  <p>
   9天数据共计越16亿条记录， 正负样本比例约为 3：100
  </p>
  <table>
   <thead>
    <tr>
     <th>
      day
     </th>
     <th>
      total
     </th>
     <th>
      positive
     </th>
     <th>
      nagitive
     </th>
     <th>
      rate
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      day_0
     </td>
     <td>
      195841983
     </td>
     <td>
      6286525
     </td>
     <td>
      189555458
     </td>
     <td>
      0.033164569
     </td>
    </tr>
    <tr>
     <td>
      day_1
     </td>
     <td>
      199563535
     </td>
     <td>
      6373290
     </td>
     <td>
      193190245
     </td>
     <td>
      0.032989709
     </td>
    </tr>
    <tr>
     <td>
      day_2
     </td>
     <td>
      196792019
     </td>
     <td>
      6249639
     </td>
     <td>
      190542380
     </td>
     <td>
      0.032799207
     </td>
    </tr>
    <tr>
     <td>
      day_3
     </td>
     <td>
      181115208
     </td>
     <td>
      5804412
     </td>
     <td>
      175310796
     </td>
     <td>
      0.033109267
     </td>
    </tr>
    <tr>
     <td>
      day_4
     </td>
     <td>
      152115810
     </td>
     <td>
      5242098
     </td>
     <td>
      146873712
     </td>
     <td>
      0.035691193
     </td>
    </tr>
    <tr>
     <td>
      day_5
     </td>
     <td>
      172548507
     </td>
     <td>
      5840421
     </td>
     <td>
      166708086
     </td>
     <td>
      0.03503382
     </td>
    </tr>
    <tr>
     <td>
      day_6
     </td>
     <td>
      204846845
     </td>
     <td>
      6482725
     </td>
     <td>
      198364120
     </td>
     <td>
      0.032680935
     </td>
    </tr>
    <tr>
     <td>
      day_7
     </td>
     <td>
      200801003
     </td>
     <td>
      6655877
     </td>
     <td>
      194145126
     </td>
     <td>
      0.034282998
     </td>
    </tr>
    <tr>
     <td>
      day_8
     </td>
     <td>
      193772492
     </td>
     <td>
      6388523
     </td>
     <td>
      187383969
     </td>
     <td>
      0.034093221
     </td>
    </tr>
    <tr>
     <td>
      sum
     </td>
     <td>
      1697397402
     </td>
     <td>
      55323510
     </td>
     <td>
      1642073892
     </td>
     <td>
      0.033691243
     </td>
    </tr>
   </tbody>
  </table>
  <h2 id="_4">
   离散特征
  </h2>
  <p>
   离散特征离散值每天约 8千万， 也就意味着 one hot 过后， 至少会有 8千万的维度， 由于之前的代码写的有问题，所以目前还没办法确定这9天的离散值是否有重复， 现在已经修复了代码逻辑， 在重新计算当中， 具体的样本离散值总数后续补充；
  </p>
  <table>
   <thead>
    <tr>
     <th>
      col_name
     </th>
     <th>
      day_0
     </th>
     <th>
      day_1
     </th>
     <th>
      day_2
     </th>
     <th>
      day_3
     </th>
     <th>
      day_4
     </th>
     <th>
      day_5
     </th>
     <th>
      day_6
     </th>
     <th>
      day_7
     </th>
     <th>
      day_8
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      cat_1
     </td>
     <td>
      18576837
     </td>
     <td>
      19053494
     </td>
     <td>
      18614758
     </td>
     <td>
      17657677
     </td>
     <td>
      16444992
     </td>
     <td>
      18523022
     </td>
     <td>
      20111071
     </td>
     <td>
      20050476
     </td>
     <td>
      19421116
     </td>
    </tr>
    <tr>
     <td>
      cat_2
     </td>
     <td>
      29427
     </td>
     <td>
      29611
     </td>
     <td>
      29651
     </td>
     <td>
      29549
     </td>
     <td>
      29136
     </td>
     <td>
      29345
     </td>
     <td>
      29913
     </td>
     <td>
      30160
     </td>
     <td>
      30166
     </td>
    </tr>
    <tr>
     <td>
      cat_3
     </td>
     <td>
      15127
     </td>
     <td>
      15049
     </td>
     <td>
      15018
     </td>
     <td>
      14935
     </td>
     <td>
      14795
     </td>
     <td>
      14824
     </td>
     <td>
      15121
     </td>
     <td>
      15176
     </td>
     <td>
      15154
     </td>
    </tr>
    <tr>
     <td>
      cat_4
     </td>
     <td>
      7295
     </td>
     <td>
      7189
     </td>
     <td>
      7255
     </td>
     <td>
      7228
     </td>
     <td>
      7104
     </td>
     <td>
      7118
     </td>
     <td>
      7338
     </td>
     <td>
      7269
     </td>
     <td>
      7308
     </td>
    </tr>
    <tr>
     <td>
      cat_5
     </td>
     <td>
      19901
     </td>
     <td>
      19546
     </td>
     <td>
      19769
     </td>
     <td>
      19666
     </td>
     <td>
      19224
     </td>
     <td>
      19316
     </td>
     <td>
      20045
     </td>
     <td>
      19813
     </td>
     <td>
      19931
     </td>
    </tr>
    <tr>
     <td>
      cat_6
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
     <td>
      3
     </td>
    </tr>
    <tr>
     <td>
      cat_7
     </td>
     <td>
      6465
     </td>
     <td>
      6491
     </td>
     <td>
      6513
     </td>
     <td>
      6535
     </td>
     <td>
      6513
     </td>
     <td>
      6497
     </td>
     <td>
      6566
     </td>
     <td>
      6578
     </td>
     <td>
      6588
     </td>
    </tr>
    <tr>
     <td>
      cat_8
     </td>
     <td>
      1310
     </td>
     <td>
      1316
     </td>
     <td>
      1323
     </td>
     <td>
      1324
     </td>
     <td>
      1316
     </td>
     <td>
      1314
     </td>
     <td>
      1326
     </td>
     <td>
      1328
     </td>
     <td>
      1331
     </td>
    </tr>
    <tr>
     <td>
      cat_9
     </td>
     <td>
      61
     </td>
     <td>
      62
     </td>
     <td>
      62
     </td>
     <td>
      59
     </td>
     <td>
      60
     </td>
     <td>
      60
     </td>
     <td>
      58
     </td>
     <td>
      59
     </td>
     <td>
      57
     </td>
    </tr>
    <tr>
     <td>
      cat_10
     </td>
     <td>
      11700067
     </td>
     <td>
      12018268
     </td>
     <td>
      11706506
     </td>
     <td>
      11154703
     </td>
     <td>
      10540645
     </td>
     <td>
      11787078
     </td>
     <td>
      12630043
     </td>
     <td>
      12662553
     </td>
     <td>
      12269234
     </td>
    </tr>
    <tr>
     <td>
      cat_11
     </td>
     <td>
      622921
     </td>
     <td>
      707291
     </td>
     <td>
      698074
     </td>
     <td>
      666536
     </td>
     <td>
      641479
     </td>
     <td>
      667257
     </td>
     <td>
      697434
     </td>
     <td>
      686620
     </td>
     <td>
      687583
     </td>
    </tr>
    <tr>
     <td>
      cat_12
     </td>
     <td>
      219556
     </td>
     <td>
      218509
     </td>
     <td>
      217897
     </td>
     <td>
      214589
     </td>
     <td>
      202958
     </td>
     <td>
      209062
     </td>
     <td>
      221789
     </td>
     <td>
      220013
     </td>
     <td>
      217864
     </td>
    </tr>
    <tr>
     <td>
      cat_13
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
     <td>
      10
     </td>
    </tr>
    <tr>
     <td>
      cat_14
     </td>
     <td>
      2209
     </td>
     <td>
      2209
     </td>
     <td>
      2209
     </td>
     <td>
      2209
     </td>
     <td>
      2208
     </td>
     <td>
      2207
     </td>
     <td>
      2209
     </td>
     <td>
      2209
     </td>
     <td>
      2209
     </td>
    </tr>
    <tr>
     <td>
      cat_15
     </td>
     <td>
      9779
     </td>
     <td>
      9797
     </td>
     <td>
      9816
     </td>
     <td>
      9809
     </td>
     <td>
      9698
     </td>
     <td>
      9735
     </td>
     <td>
      9867
     </td>
     <td>
      9869
     </td>
     <td>
      9886
     </td>
    </tr>
    <tr>
     <td>
      cat_16
     </td>
     <td>
      71
     </td>
     <td>
      72
     </td>
     <td>
      86
     </td>
     <td>
      71
     </td>
     <td>
      71
     </td>
     <td>
      69
     </td>
     <td>
      73
     </td>
     <td>
      72
     </td>
     <td>
      72
     </td>
    </tr>
    <tr>
     <td>
      cat_17
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
     <td>
      4
     </td>
    </tr>
    <tr>
     <td>
      cat_18
     </td>
     <td>
      963
     </td>
     <td>
      953
     </td>
     <td>
      959
     </td>
     <td>
      956
     </td>
     <td>
      943
     </td>
     <td>
      949
     </td>
     <td>
      967
     </td>
     <td>
      960
     </td>
     <td>
      964
     </td>
    </tr>
    <tr>
     <td>
      cat_19
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
     <td>
      14
     </td>
    </tr>
    <tr>
     <td>
      cat_20
     </td>
     <td>
      22022124
     </td>
     <td>
      22603235
     </td>
     <td>
      22016296
     </td>
     <td>
      20860924
     </td>
     <td>
      19183024
     </td>
     <td>
      21678326
     </td>
     <td>
      23667638
     </td>
     <td>
      23481809
     </td>
     <td>
      22952958
     </td>
    </tr>
    <tr>
     <td>
      cat_21
     </td>
     <td>
      4384510
     </td>
     <td>
      4553157
     </td>
     <td>
      4478806
     </td>
     <td>
      4274080
     </td>
     <td>
      4025904
     </td>
     <td>
      4431445
     </td>
     <td>
      4750297
     </td>
     <td>
      4734814
     </td>
     <td>
      4643760
     </td>
    </tr>
    <tr>
     <td>
      cat_22
     </td>
     <td>
      15960286
     </td>
     <td>
      16382859
     </td>
     <td>
      16007216
     </td>
     <td>
      15220147
     </td>
     <td>
      14222951
     </td>
     <td>
      16005307
     </td>
     <td>
      17345375
     </td>
     <td>
      17332825
     </td>
     <td>
      16777855
     </td>
    </tr>
    <tr>
     <td>
      cat_23
     </td>
     <td>
      290588
     </td>
     <td>
      291641
     </td>
     <td>
      290810
     </td>
     <td>
      286279
     </td>
     <td>
      275075
     </td>
     <td>
      284760
     </td>
     <td>
      302921
     </td>
     <td>
      299734
     </td>
     <td>
      298720
     </td>
    </tr>
    <tr>
     <td>
      cat_24
     </td>
     <td>
      10829
     </td>
     <td>
      10903
     </td>
     <td>
      10844
     </td>
     <td>
      10831
     </td>
     <td>
      10680
     </td>
     <td>
      10743
     </td>
     <td>
      10908
     </td>
     <td>
      10864
     </td>
     <td>
      10912
     </td>
    </tr>
    <tr>
     <td>
      cat_25
     </td>
     <td>
      95
     </td>
     <td>
      90
     </td>
     <td>
      98
     </td>
     <td>
      96
     </td>
     <td>
      97
     </td>
     <td>
      97
     </td>
     <td>
      94
     </td>
     <td>
      94
     </td>
     <td>
      91
     </td>
    </tr>
    <tr>
     <td>
      cat_26
     </td>
     <td>
      34
     </td>
     <td>
      34
     </td>
     <td>
      35
     </td>
     <td>
      34
     </td>
     <td>
      33
     </td>
     <td>
      34
     </td>
     <td>
      35
     </td>
     <td>
      34
     </td>
     <td>
      35
     </td>
    </tr>
    <tr>
     <td>
      total_row
     </td>
     <td>
      73880486
     </td>
     <td>
      75931807
     </td>
     <td>
      74134032
     </td>
     <td>
      70438268
     </td>
     <td>
      65638937
     </td>
     <td>
      73688596
     </td>
     <td>
      79831119
     </td>
     <td>
      79573360
     </td>
     <td>
      77373825
     </td>
    </tr>
   </tbody>
  </table>
  <h2 id="_5">
   连续特征
  </h2>
  <table>
   <thead>
    <tr>
     <th>
      -
     </th>
     <th>
      con_1
     </th>
     <th>
      con_2
     </th>
     <th>
      con_3
     </th>
     <th>
      con_4
     </th>
     <th>
      con_5
     </th>
     <th>
      con_6
     </th>
     <th>
      con_7
     </th>
     <th>
      con_8
     </th>
     <th>
      con_9
     </th>
     <th>
      con_10
     </th>
     <th>
      con_11
     </th>
     <th>
      con_12
     </th>
     <th>
      con_13
     </th>
    </tr>
   </thead>
   <tbody>
    <tr>
     <td>
      min
     </td>
     <td>
      1
     </td>
     <td>
      1
     </td>
     <td>
      0
     </td>
     <td>
      0
     </td>
     <td>
      1
     </td>
     <td>
      0
     </td>
     <td>
      0
     </td>
     <td>
      -1
     </td>
     <td>
      0
     </td>
     <td>
      0
     </td>
     <td>
      1
     </td>
     <td>
      0
     </td>
     <td>
      0
     </td>
    </tr>
    <tr>
     <td>
      mean
     </td>
     <td>
      35
     </td>
     <td>
      426
     </td>
     <td>
      7
     </td>
     <td>
      130
     </td>
     <td>
      22
     </td>
     <td>
      1
     </td>
     <td>
      0
     </td>
     <td>
      112
     </td>
     <td>
      9
     </td>
     <td>
      0
     </td>
     <td>
      4
     </td>
     <td>
      21625
     </td>
     <td>
      9
     </td>
    </tr>
    <tr>
     <td>
      max
     </td>
     <td>
      65535
     </td>
     <td>
      8000
     </td>
     <td>
      4933
     </td>
     <td>
      746810
     </td>
     <td>
      8000
     </td>
     <td>
      65479
     </td>
     <td>
      5277
     </td>
     <td>
      400947
     </td>
     <td>
      16050
     </td>
     <td>
      19
     </td>
     <td>
      555
     </td>
     <td>
      35058398
     </td>
     <td>
      21843
     </td>
    </tr>
   </tbody>
  </table>
  <script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.1/highlight.min.js">
  </script>
  <script>
   hljs.initHighlightingOnLoad();
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript">
  </script>
  <script type="text/javascript">
   MathJax.Hub.Config({"showProcessingMessages" : false,"messageStyle" : "none","tex2jax": { inlineMath: [ [ "$", "$" ] ] }});
  </script>
 </body>
</html>